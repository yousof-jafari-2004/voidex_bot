require('dotenv').config();
const { Telegraf, Markup } = require('telegraf');
const mongoose = require('mongoose');
const User = require('./models/user');

// admin telegram id
let isAdmin = false;
const ADMIN_ID = '6956422313';
// is user registered
let AUTH = false;
// what is the current user plan
let userPlanRequest;

// Ø§ØªØµØ§Ù„ Ø¨Ù‡ MongoDB
mongoose.connect(process.env.MONGO_URL)
  .then(() => console.log('âœ… MongoDB ÙˆØµÙ„ Ø´Ø¯'))
  .catch((err) => console.error('âŒ MongoDB Ø§Ø±ÙˆØ±:', err));

// Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø§Øª
const bot = new Telegraf(process.env.BOT_TOKEN);

// ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯Ø± Ù…Ø±Ø§Ø­Ù„ Ù…Ø®ØªÙ„Ù
const waitingForName = new Set();
const waitingForPhone = new Set();

// Ù…Ù†ÙˆÛŒ Ø¯Ø§Ø¦Ù…ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§ÛŒÛŒÙ† Ú†Øª
const mainMenu = Markup.keyboard([
  ['ðŸ“ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… (Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø¯ÛŒÙ‡)', 'ðŸ“‹ ØªÙ…Ø§Ù…ÛŒ Ù¾Ù„Ù† Ù‡Ø§'],
  ['ðŸ“¦ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ù„Ù† Ù…Ù†', 'â„¹ï¸ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„'],
  ['ðŸ“ž Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ùˆ Ø³ÙˆØ§Ù„Ø§Øª', 'ðŸ’° Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒÙ†Ú© Ø¯Ø¹ÙˆØª']
]).resize().oneTime(false);

// ØªÙ†Ø¸ÛŒÙ… Ù…Ù†ÙˆÛŒ Ú†Ø³Ø¨Ø§Ù†
const setupPersistentMenu = () => {
  if(!isAdmin)
  {
    // if the user was not admin
    bot.telegram.setMyCommands([
      { command: 'start', description: 'Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Ø±Ø¨Ø§Øª' },
      { command: 'register', description: 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… (Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø¯ÛŒÙ‡)' },
      { command: 'plans', description: 'ØªÙ…Ø§Ù…ÛŒ Ù¾Ù„Ù† Ù‡Ø§' },
      { command: 'myplan', description: 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ù„Ù† Ù…Ù†' },
      { command: 'about', description: 'Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„' },
      { command: 'contact', description: 'Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ùˆ Ø³ÙˆØ§Ù„Ø§Øª' },
      { command: 'invite', description: 'Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒÙ†Ú© Ø¯Ø¹ÙˆØª' }
    ]);
  }else {

    // if the user was admin
    bot.telegram.setMyCommands([
      { command: 'start', description: 'Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯ Ø±Ø¨Ø§Øª' },
      { command: 'register', description: 'Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…' },
      { command: 'messages', description: 'Ù¾ÛŒØ§Ù… Ù‡Ø§' },
      { command: 'change_user_plan', description: 'ÙˆÛŒØ±Ø§ÛŒØ´ Ù¾Ù„Ù† Ú©Ø§Ø±Ø¨Ø±' },
      { command: 'send_message', description: 'ÙØ±Ø³ØªØ§Ø¯Ù† Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±' },
      { command: 'users_count', description: 'ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†' },
      { command: 'users_list', description: 'Ù„ÛŒØ³Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†' }
    ]);
  }
};


// fetch users count
const getUserStats = async btt => {
  try {
    const totalUsers = await User.countDocuments();
    return totalUsers;
  } catch (err) {
    btt.reply('Ø§Ø±ÙˆØ± Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø±ÛŒØ§ÙØª ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†');
  }
}

// fetch users details
const getAllUsers = async () => {
  try {
    const users = await User.find();
    return users;
  } catch (err) {
    btt.reply('Ø§Ø±ÙˆØ± Ù‡Ù†Ú¯Ø§Ù… Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†');
  }
}

// Ø´Ø±ÙˆØ¹ Ø¨Ø§Øª
bot.start(async (ctx) => {
  const { id, username, first_name } = ctx.from;

  const existingUser = await User.findOne({ telegramId: String(id) });

  if (!existingUser) {
    await User.create({
      telegramId: String(id),
      username,
      first_name,
      phoneNumber: '',
      plan: 'free',
      service: 'free',
      vpn_server: "this is a test config",
      isPlanExpired: false,
      planStartedDate: null,
      planExpiredDate: null,
      recievedGift: false,
      isAdmin: false,
    });
  } else {
    AUTH = existingUser.phoneNumber == '' ? false : true;
  }

  // check if the user is admin or not
  if(ADMIN_ID == ctx.from.id)
  {
    isAdmin = true
  }else {
    isAdmin = false;
  }

  // ØªÙ†Ø¸ÛŒÙ… Ù…Ù†ÙˆÛŒ Ú†Ø³Ø¨Ø§Ù†
  setupPersistentMenu();

  await ctx.reply(
    `
ðŸ‘‹ Ø¨Ù‡ Ø±Ø¨Ø§Øª VoidNet Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!
Ø¨Ø§ Ù…Ø§ Ø§ÛŒÙ†ØªØ±Ù†ØªÛŒ Ø§Ù…Ù†ØŒ Ø³Ø±ÛŒØ¹ Ùˆ Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø±Ø§ ØªØ¬Ø±Ø¨Ù‡ Ú©Ù†ÛŒØ¯.
ðŸŒŸ Ø§Ù…ØªØ­Ø§Ù† Ø±Ø§ÛŒÚ¯Ø§Ù†:
Ø´Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² ÛŒÚ© Ø³Ø±ÙˆØ± VPN Ø±Ø§ÛŒÚ¯Ø§Ù† Ø¨Ù‡ Ù…Ø¯Øª Û± Ø±ÙˆØ² Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ ØªØ§ Ú©ÛŒÙÛŒØª Ø®Ø¯Ù…Ø§Øª Ù…Ø§ Ø±Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.

âœ… Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§ÛŒ ØªØ®ØµØµÛŒ:
ðŸ”¸ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø¨Ù‡ ÛŒÙˆØªÛŒÙˆØ¨ Ùˆ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…
ðŸ”¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø­Ø¬ÛŒÙ… Ø¨Ø§ Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§ Ùˆ Ø¨Ø¯ÙˆÙ† Ù‚Ø·Ø¹ÛŒ
ðŸŽ® Ø§Ø¬Ø±Ø§ÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¨Ø¯ÙˆÙ† Ù¾ÛŒÙ†Ú¯ Ø¨Ø§Ù„Ø§ Ùˆ Ù„Ú¯
ðŸ’¼ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ±ÛŒØ¯ØŒ Ø¨ÙˆØ±Ø³ Ùˆ ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ†
ðŸ” Ø¯Ø§Ø±Ø§ÛŒ IP Ø«Ø§Ø¨Øª Ùˆ Ø§Ø®ØªØµØ§ØµÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø±Ø§Ø­Øªâ€ŒØªØ± Ø¯Ø± Ø³Ø§ÛŒØªâ€ŒÙ‡Ø§

âš™ï¸ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ ÙÙ†ÛŒ:
ðŸ”¹ Ø¢ÛŒâ€ŒÙ¾ÛŒ Ø§Ø³ØªØ§ØªÛŒÚ© (Ø«Ø§Ø¨Øª) Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©Ø§Ø±Ø¨Ø±
ðŸ”¸ Ø§Ù…Ù†ÛŒØª Ùˆ Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
ðŸ“¶ Ø§ØªØµØ§Ù„ Ù¾Ø§ÛŒØ¯Ø§Ø± Ùˆ Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§
ðŸ•’ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø·ÙˆÙ„Ø§Ù†ÛŒâ€ŒÙ…Ø¯Øª Ø¨Ø¯ÙˆÙ† Ø§ÙØª Ú©ÛŒÙÛŒØª
ðŸŒ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± ÙˆÛŒÙ†Ø¯ÙˆØ²ØŒ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ØŒ iOSØŒ Ù„ÛŒÙ†ÙˆÚ©Ø³ Ùˆ Ù…Ú©

ðŸ’¼ Ù…Ø§ Û³ Ù¾Ù„Ù† Ù…ØªÙ†ÙˆØ¹ Ø¨Ø±Ø§ÛŒ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…:
ðŸ”¹ Ù¾Ù„Ù† Ù¾Ø§ÛŒÙ‡ â€“ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¹Ø§Ø¯ÛŒ
ðŸ”¸ Ù¾Ù„Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ â€“ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡
ðŸ”º Ù¾Ù„Ù† VIP â€“ Ø³Ø±Ø¹Øª Ùˆ Ù¾Ø§ÛŒØ¯Ø§Ø±ÛŒ Ø¨Ø§Ù„Ø§ Ø¨Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒØ¯Ø§Ø±

ðŸ“² Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø«Ø¨Øª Ù†Ø§Ù… Ùˆ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù‡Ø¯ÛŒÙ‡ ÛŒÚ© Ø±ÙˆØ²Ù‡ Ù„Ø·ÙØ§ Ø§Ø² Ù…Ù†ÙˆÛŒ Ù¾Ø§ÛŒÛŒÙ† Ú¯Ø²ÛŒÙ†Ù‡ Ø«Ø¨Øª Ù†Ø§Ù… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯
    `,
    mainMenu
  );
});

// my plan description
bot.hears(['ðŸ“¦ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ù„Ù† Ù…Ù†', 'myPlan'], async ctx => {
  let userData = await User.findOne({telegramId:ctx.from.id});

  let planType;

  if(userData.plan == 'basic'){
    planType = 'ðŸ”° Ù¾Ù„Ù† Ø§Ù‚ØªØµØ§Ø¯ÛŒ ';
  } else if(userData.plan == 'pro'){
    planType = 'ðŸš€ Ù¾Ù„Ù† Ù¾ÛŒØ´Ø±ÙØªÙ‡ ';
  } else if(userData.plan == 'vip'){
    planType = 'ðŸ‘‘ Ù¾Ù„Ù† ÙˆÛŒÚ˜Ù‡' 
  }else {
    planType = 'ðŸŽ Ù‡Ø¯ÛŒÙ‡ ÛŒÚ© Ø±ÙˆØ²Ù‡';
  }

  await ctx.reply(`
    Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø³ØªÙ‡ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§:
    Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€
    Ù†Ø§Ù… Ø¨Ø³ØªÙ‡: ${ planType } 
    ÙˆØ¶Ø¹ÛŒØª Ø¨Ø³ØªÙ‡ : ${ (userData.isPlanExpired) ? 'ØºÛŒØ± ÙØ¹Ø§Ù„' : 'ÙØ¹Ø§Ù„' }
    Ù…Ø¯Øª Ø§Ø¹ØªØ¨Ø§Ø± Ø¨Ø³ØªÙ‡: Û³Û¹ Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡
    Ø­Ø¬Ù… Ù…ØµØ±ÙÛŒ Ø´Ù…Ø§: Û³Û¹ Ú¯ÛŒÚ¯ Ù…ØµØ±Ù Ú©Ø±Ø¯Ù‡ Ø§ÛŒØ¯
    Ø­Ø¬Ù… Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡: Û·Û¸ Ú¯ÛŒÚ¯ Ø¨Ø§Ù‚ÛŒ Ù…Ø§Ù†Ø¯Ù‡
    Ø¢ÛŒ Ù¾ÛŒ Ø«Ø§Ø¨Øª : Ù†Ø¯Ø§Ø±Ø¯
    Ø³Ø±ÙˆØ± Ø´Ù…Ø§ : Ø¢Ù„Ù…Ø§Ù† (Ù‚Ø§Ø¨Ù„ ØªØºÛŒÛŒØ±)
  `);
});



// Ø¯Ø³ØªÙˆØ±Ø§Øª Ù…Ù†Ùˆ
bot.hears(['ðŸ“ž Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ùˆ Ø³ÙˆØ§Ù„Ø§Øª', '/contact'], ctx => {
  ctx.reply(`
ðŸ†˜ Ø³ÙˆØ§Ù„Ø§Øª Ù…ØªØ¯Ø§ÙˆÙ„ Ùˆ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³Ø±ÛŒØ¹

â“ Ú†Ø·ÙˆØ± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†Ù…ØŸ
âœ… Ø§Ø² Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ Ø±ÙˆÛŒ "ðŸŽ‰ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø¯ÛŒÙ‡" Ø¨Ø²Ù†ØŒ Ø§Ø³Ù…Øª Ùˆ Ø´Ù…Ø§Ø±Ù‡â€ŒØª Ø±Ùˆ ÙˆØ§Ø±Ø¯ Ú©Ù† ØªØ§ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…Øª Ú©Ø§Ù…Ù„ Ø¨Ø´Ù‡.

â“ Ø¨Ø¹Ø¯ Ø§Ø² Ø®Ø±ÛŒØ¯ØŒ Ú†ÛŒ Ú©Ø§Ø± Ú©Ù†Ù…ØŸ
âœ… ÙÙ‚Ø· ÛŒÙ‡ Ø¹Ú©Ø³ Ø§Ø² Ø±Ø³ÛŒØ¯ Ù¾Ø±Ø¯Ø§Ø®ØªØª Ø±Ùˆ Ø¨Ø±Ø§ÛŒ Ø±Ø¨Ø§Øª Ø¨ÙØ±Ø³Øª. Ø±Ø¨Ø§Øª Ø®ÙˆØ¯Ø´ Ø±Ø³ÛŒØ¯ Ø±Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ùˆ Ø¨Ø³ØªÙ‡â€ŒØª Ø±Ùˆ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ù‡.

â“ Ú†Ù‡ Ù†ÙˆØ¹ Ø¨Ø³ØªÙ‡â€ŒÙ‡Ø§ÛŒÛŒ Ù…ÙˆØ¬ÙˆØ¯Ù‡ØŸ
âœ… Ø§Ø² Ù…Ù†ÙˆÛŒ "ðŸ“¦ ØªÙ…Ø§Ù…ÛŒ Ù¾Ù„Ù†â€ŒÙ‡Ø§" Ù‡Ù…Ù‡â€ŒÛŒ Ù¾Ù„Ù†â€ŒÙ‡Ø§ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡â€ŒÙ†. Ø¨Ø³ØªÙ‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø±Ø¹ØªØŒ Ù…Ø¯Øª Ùˆ Ù‚ÛŒÙ…Øª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø´Ø¯Ù†.

â“ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ú†Ù‚Ø¯Ø± Ø·ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ø´Ù‡ØŸ
âœ… Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ú©Ù…ØªØ± Ø§Ø² Û³Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ Ø±Ø³ÛŒØ¯ØŒ Ø¨Ø³ØªÙ‡ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒØ´Ù‡. Ø§Ú¯Ù‡ Ø¨ÛŒØ´ØªØ± Ø·ÙˆÙ„ Ú©Ø´ÛŒØ¯ØŒ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù¾ÛŒØ§Ù… Ø¨Ø¯Ù‡.

â“ Ù¾Ø±ÙˆÚ©Ø³ÛŒ ÛŒØ§ VPN Ú†Ø¬ÙˆØ±ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ù…ØŸ
âœ… Ø¨Ø¹Ø¯ Ø§Ø² ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒØŒ Ø±Ø¨Ø§Øª Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§ØªØµØ§Ù„ Ø±Ùˆ Ø¨Ø±Ø§Øª Ù…ÛŒâ€ŒÙØ±Ø³ØªÙ‡.

â“ Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ø¨Ø§ ÛŒÙ‡ Ø®Ø±ÛŒØ¯ØŒ Ú†Ù†Ø¯ Ù†ÙØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù†ØŸ
âœ… Ø§Ú¯Ø± Ø¨Ø³ØªÙ‡ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø§ÛŒÙ† Ù‚Ø§Ø¨Ù„ÛŒØª Ø±Ùˆ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ù‡ Ù…Ø´Ú©Ù„ÛŒ Ù†ÛŒØ³Øª 

â“ Ù¾Ø±ÙˆÚ©Ø³ÛŒ ØªÙ„Ú¯Ø±Ø§Ù… Ú†ÛŒÙ‡ØŸ
âœ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ ÛŒÙ‡ Ø±Ø§Ù‡ Ø³Ø±ÛŒØ¹ Ùˆ Ø§Ù…Ù† Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…Ù‡. Ø¨Ø¹Ø¯ Ø§Ø² Ø®Ø±ÛŒØ¯ØŒ Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ Ù‡Ø¯ÛŒÙ‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒ.

â“ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ Ø±ÙˆÛŒ Ú†Ù‡ Ø³ÛŒØ³ØªÙ…â€ŒØ¹Ø§Ù…Ù„â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†ØŸ
âœ… Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ØŒ iOSØŒ ÙˆÛŒÙ†Ø¯ÙˆØ²ØŒ Ù…Ú© Ùˆ Ø­ØªÛŒ Ù„ÛŒÙ†ÙˆÚ©Ø³ â€” Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª!

â“ Ø§Ú¯Ø± Ù…Ø´Ú©Ù„Ù… Ø­Ù„ Ù†Ø´Ø¯ Ú†ÛŒ Ú©Ø§Ø± Ú©Ù†Ù…ØŸ
ðŸ†˜ Ù†Ú¯Ø±Ø§Ù† Ù†Ø¨Ø§Ø´. Ø¨Ø§ Ø²Ø¯Ù† Ø¯Ø³ØªÙˆØ± /adminForce Ùˆ Ø¨Ø¹Ø¯ Ù†ÙˆØ´ØªÙ† Ù¾ÛŒØ§Ù…Øª Ù…ÛŒØªÙˆÙ†ÛŒ Ù¾ÛŒØ§Ù…Øª Ø±Ùˆ Ø¨Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†Ù‡ Ùˆ Ø¯Ø± Ú©Ù…ØªØ± Ø§Ø² Û±Û° Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¬ÙˆØ§Ø¨ Ø´Ù…Ø§ Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯Ù‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.
`);
});

bot.hears(['ðŸ“ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… (Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø¯ÛŒÙ‡)', '/register'], async (ctx) => {
  let currentUser = await User.findOne({telegramId: String(ctx.from.id)});
  // if user already claimed his gift don't give it again
  if(currentUser.recievedGift)
  {
    return ctx.reply('Ø´Ù…Ø§ Ù‚Ø¨Ù„Ø§ Ù‡Ø¯ÛŒÙ‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ø§ÛŒØ¯');
  }else {
    waitingForName.add(ctx.from.id);
    ctx.reply('Ù„Ø·ÙØ§ Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
  }
});


bot.hears(['ðŸ“‹ ØªÙ…Ø§Ù…ÛŒ Ù¾Ù„Ù† Ù‡Ø§', '/plans'], (ctx) => {
  ctx.reply(`ðŸ”° Ù¾Ù„Ù† Ø§Ù‚ØªØµØ§Ø¯ÛŒ | ðŸŒ± Basic

ðŸ’  Ú©ÛŒÙÛŒØª: Ø®ÙˆØ¨
ðŸ“¶ Ø³Ø±Ø¹Øª: Ù…ØªÙˆØ³Ø·
ðŸŒ Ù‚Ø§Ø¨Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Û´ Ú©Ø´ÙˆØ± Ù…Ø®ØªÙ„Ù
ðŸ‘¥ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±ÙˆÛŒ Ø³Ø±ÙˆØ±: ØªØ§ 1 Ù†ÙØ±
ðŸ“¡ Ù¾ÛŒÙ†Ú¯: Ù…Ø¹Ù…ÙˆÙ„ÛŒ
ðŸ“¦ Ø­Ø¬Ù…: Û±Û³Û° Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØª
ðŸ’µ Ù‚ÛŒÙ…Øª: 68 Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù† / Ù…Ø§Ù‡
ðŸŽ¯ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ: ØªÙ„Ú¯Ø±Ø§Ù…ØŒ ÛŒÙˆØªÛŒÙˆØ¨ØŒ ÙˆØ¨â€ŒÚ¯Ø±Ø¯ÛŒØŒ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù…
_____________________

ðŸš€ Ù¾Ù„Ù† Ù¾ÛŒØ´Ø±ÙØªÙ‡ | âš¡ Pro

ðŸ’  Ú©ÛŒÙÛŒØª: Ø¨Ø§Ù„Ø§
ðŸ“¶ Ø³Ø±Ø¹Øª: Ø¨Ø§Ù„Ø§
ðŸŒ Ù‚Ø§Ø¨Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Û²Û° Ú©Ø´ÙˆØ± Ù…Ø®ØªÙ„Ù
ðŸ‘¥ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±ÙˆÛŒ Ø³Ø±ÙˆØ±: ØªØ§ 2 Ù†ÙØ±
ðŸ“¡ Ù¾ÛŒÙ†Ú¯: Ù¾Ø§ÛŒÛŒÙ†
ðŸ“¦ Ø­Ø¬Ù…: Û²ÛµÛ° Ú¯ÛŒÚ¯Ø§Ø¨Ø§ÛŒØª
ðŸ’µ Ù‚ÛŒÙ…Øª: Û¹Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù† / Ù…Ø§Ù‡

ðŸŽ¯ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ: ØªÙ…Ø§Ø³ ØªØµÙˆÛŒØ±ÛŒØŒ ÛŒÙˆØªÛŒÙˆØ¨ HDØŒ Ø§ÛŒÙ†Ø³ØªØ§Ú¯Ø±Ø§Ù… Ø±ÙˆØ§Ù†, Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø³Ù†Ú¯ÛŒÙ†
_____________________

ðŸ‘‘ Ù¾Ù„Ù† ÙˆÛŒÚ˜Ù‡ | ðŸ¦… VIP

ðŸ’  Ú©ÛŒÙÛŒØª: Ø®ÛŒÙ„ÛŒ Ø¨Ø§Ù„Ø§
ðŸ“¶ Ø³Ø±Ø¹Øª: Ø¹Ø§Ù„ÛŒ
ðŸ‘¥ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±ÙˆÛŒ Ø³Ø±ÙˆØ±: ØªØ§ 3 Ù†ÙØ±
ðŸŒ Ù‚Ø§Ø¨Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Û´Û°+ Ú©Ø´ÙˆØ± Ù…Ø®ØªÙ„Ù
ðŸ“ Ø¢ÛŒâ€ŒÙ¾ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ Ùˆ Ø«Ø§Ø¨Øª (Static)
ðŸ”’ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±ØŒ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§
ðŸ“ˆ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§ÛŒÛŒ Ù…Ø«Ù„:
Binance â€“ Kucoin â€“ Bybit â€“ OKX â€“ MEXC Ùˆ ...
ðŸ“¡ Ù¾ÛŒÙ†Ú¯: Ø¨Ø³ÛŒØ§Ø± Ù¾Ø§ÛŒÛŒÙ†
ðŸ“¦ Ø­Ø¬Ù…: Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯
ðŸ’µ Ù‚ÛŒÙ…Øª: Û±Û³Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù† / Ù…Ø§Ù‡

ðŸŽ¯ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ: Ú¯ÛŒÙ… Ø¢Ù†Ù„Ø§ÛŒÙ†ØŒ Ø§Ø³ØªØ±ÛŒÙ… 4KØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ Ø¨Ø¯ÙˆÙ† Ù‚Ø·Ø¹ÛŒ

(Ø´Ù…Ø§ Ù…ÛŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø¨Ø³ØªÙ‡ Ø®ÙˆØ¯ Ø±Ø§ Ø´Ø®ØµÛŒ Ø³Ø§Ø²ÛŒ Ú©Ù†ÛŒØ¯)

Ù„Ø·ÙØ§ Ø§Ø² Ù…Ù†ÙˆÛŒ Ø²ÛŒØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯
`,
    Markup.inlineKeyboard([
      [Markup.button.callback('ðŸ”° Ù¾Ù„Ù† Ø§Ù‚ØªØµØ§Ø¯ÛŒ | ðŸŒ± Basic', 'basic')],
      [Markup.button.callback('ðŸš€ Ù¾Ù„Ù† Ù¾ÛŒØ´Ø±ÙØªÙ‡ | âš¡ Pro', 'pro')],
      [Markup.button.callback('ðŸ‘‘ Ù¾Ù„Ù† ÙˆÛŒÚ˜Ù‡ | ðŸ¦… VIP', 'vip')],
    ])
  );
});

bot.hears(['â„¹ï¸ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú©Ø§Ù…Ù„', '/about'], ctx => {
  ctx.reply(`
ðŸ¤– Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø±Ø¨Ø§Øª Ø®Ø±ÛŒØ¯ Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø¯ÛŒÙ‡

Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø±Ø³Ù…ÛŒ Ù…Ø§ Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒ! ðŸŒŸ
Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø¨Ù‡ Ø³Ø§Ø¯Ú¯ÛŒ Ùˆ Ø¯Ø± Ø¹Ø±Ø¶ Ú†Ù†Ø¯ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†ÛŒØŒ Ø®Ø±ÛŒØ¯Øª Ø±Ùˆ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯ÛŒØŒ Ùˆ Ù‡Ø¯ÛŒÙ‡â€ŒØ§Øª Ø±Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒ!

âœ… Ù…Ø±Ø§Ø­Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:

1. Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ø§ÙˆÙ„ÛŒÙ‡  
- Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ ðŸŽ‰ Â«Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ù‡Ø¯ÛŒÙ‡Â» Ú©Ù„ÛŒÚ© Ú©Ù†.  
- Ø§Ø³Ù…Øª Ø±Ùˆ ÙˆØ§Ø±Ø¯ Ú©Ù†.  
- Ø³Ù¾Ø³ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†Øª Ø±Ùˆ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø¯Ú©Ù…Ù‡ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†.

2. Ø§Ù†Ø¬Ø§Ù… Ø®Ø±ÛŒØ¯  
- ÙˆØ§Ø±Ø¯ Ú¯Ø²ÛŒÙ†Ù‡ Â«ØªÙ…Ø§Ù…ÛŒ Ù¾Ù„Ù†â€ŒÙ‡Ø§Â» Ø´Ùˆ Ùˆ Ø¨Ø³ØªÙ‡â€ŒÛŒ Ù…ÙˆØ±Ø¯Ù†Ø¸Ø±Øª Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†.  
- Ø¨Ø¹Ø¯ØŒ Ù…Ø¯Øª Ø²Ù…Ø§Ù† Ø¨Ø³ØªÙ‡ Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†.  
- Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù‡ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ØŒ ÛŒÙ‡ Ø±Ø³ÛŒØ¯ ØªØµÙˆÛŒØ±ÛŒ Ø§Ø² Ø®Ø±ÛŒØ¯Øª Ù…ÛŒâ€ŒÙØ±Ø³ØªÛŒ.

3. Ø§Ø±Ø³Ø§Ù„ Ø±Ø³ÛŒØ¯  
ðŸ“¸ ØªÙ†Ù‡Ø§ Ú©Ø§Ø±ÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯ÛŒ Ø§ÛŒÙ†Ù‡ Ú©Ù‡ ÛŒÙ‡ Ø¹Ú©Ø³ Ø§Ø² Ø±Ø³ÛŒØ¯Øª Ø¨Ø±Ø§ÛŒ Ø±Ø¨Ø§Øª Ø¨ÙØ±Ø³ØªÛŒ.  
Ù†ÛŒØ§Ø²ÛŒ Ù†ÛŒØ³Øª Ú†ÛŒØ²ÛŒ ØªÙˆØ¶ÛŒØ­ Ø¨Ø¯ÛŒ ÛŒØ§ Ú©Ø§Ø±ÛŒ Ø¨Ú©Ù†ÛŒØŒ Ø±Ø¨Ø§Øª Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø±Ø³ÛŒØ¯ØªÙˆ Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù‡ Ùˆ Ø§Ú¯Ø± Ù…Ø¹ØªØ¨Ø± Ø¨Ø§Ø´Ù‡ Ø¨Ø³ØªÙ‡â€ŒØª Ø±Ùˆ ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ù‡! ðŸŽ

ðŸ’¬ Ø§Ú¯Ù‡ Ø³ÙˆØ§Ù„ Ø¯ÛŒÚ¯Ù‡â€ŒØ§ÛŒ Ø¯Ø§Ø±ÛŒØŒ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø§Ø² Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ Ú¯Ø²ÛŒÙ†Ù‡ Â«Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ùˆ Ø³ÙˆØ§Ù„Ø§ØªÂ» Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒ.
  `);
});

bot.hears(['ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', '/users_count'], async ctx => {
  await ctx.reply(`ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ú©Ø§Ø±Ø¨Ø± Ù‡Ø§ÛŒ Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø±Ø¯Ù‡ ${getUserStats(ctx)}`);
});

bot.hears(['Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ù„ Ú©Ø§Ø±Ø¨Ø± Ù‡Ø§', '/users_list'], async ctx => {
  let allUsers = await getAllUsers(ctx);
  allUsers.forEach(theUser => {
    ctx.reply(`Ù†Ø§Ù… :${theUser.first_name}
      Ø¢ÛŒ Ø¯ÛŒ :${theUser.telegramId}
      Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ :${theUser.telegramId}`);
  });
});

// Ø¯Ø±ÛŒØ§ÙØª Ù¾ÛŒØ§Ù… Ù…ØªÙ†ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±
bot.on('text', async (ctx) => {
  const userId = ctx.from.id;
  const text = ctx.message.text;

  // Ù…Ø±Ø­Ù„Ù‡ Û±: Ø°Ø®ÛŒØ±Ù‡ Ù†Ø§Ù…
  if (waitingForName.has(userId)) {
    waitingForName.delete(userId);
    waitingForPhone.add(userId);

    await User.findOneAndUpdate(
      { telegramId: String(userId) },
      { first_name: text, recievedGift: true },
      { new: true }
    );

    return ctx.reply('âœ… Ù†Ø§Ù… Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯. Ø­Ø§Ù„Ø§ Ù„Ø·ÙØ§Ù‹ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:');
  }

  // Ù…Ø±Ø­Ù„Ù‡ Û²: Ø°Ø®ÛŒØ±Ù‡ Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³
  if (waitingForPhone.has(userId)) {
    waitingForPhone.delete(userId);

    await User.findOneAndUpdate(
      { telegramId: String(userId) },
      { phoneNumber: text, recievedGift: true },
    );

    const theUser = await User.findOne({ telegramId: String(userId) });

    await ctx.reply(`âœ… Ø´Ù…Ø§Ø±Ù‡ Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯: ${text}`);
    await ctx.reply(`ðŸŽ Ø§ÛŒÙ† Ù‡Ù… Ú©Ø§Ù†ÙÛŒÚ¯ ØªØ³Øª Ø±Ø§ÛŒÚ¯Ø§Ù† Ø´Ù…Ø§`);
    await ctx.reply(`${theUser.vpn_server}`);
    return await ctx.reply(`ØªÙˆØ¬Ù‡ Ú©Ù†ÛŒØ¯ Ú©Ù‡ Ø§ÛŒÙ† Ú©Ø§Ù†ÙÛŒÚ¯ ÙÙ‚Ø· ØªØ§ Û²Û´ Ø³Ø§Ø¹Øª Ø¢ÛŒÙ†Ø¯Ù‡ ÙØ¹Ø§Ù„ Ù‡Ø³Øª Ùˆ Ø¨Ø¹Ø¯ Ø§Ø² Ø§ÙˆÙ† ØºÛŒØ± ÙØ¹Ø§Ù„ Ù…ÛŒØ´Ù‡`);
  }

  // Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø±ÙˆÙ†Ø¯ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù†Ø¨ÙˆØ¯
  ctx.reply('Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø¯Ø³ØªÙˆØ± /start Ø±Ùˆ Ø¨ÙØ±Ø³Øª Ùˆ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…" Ø¨Ø²Ù†.');
});

let price = 0;

// choose the service
bot.action('basic', (ctx) => {
  ctx.reply(`Ø³Ø±ÙˆÛŒØ³ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯
    Ø´Ù…Ø§ Ù…ÛŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø­Ø¬Ù… Ø¨Ø³ØªÙ‡ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯`,
    Markup.inlineKeyboard([
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ ÛŒÚ© Ù…Ø§Ù‡Ù‡ | Û¶Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '1_mounth_b')],
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ Ø³Ù‡ Ù…Ø§Ù‡Ù‡ | Û±Û·Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '3_mounth_b')],
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ Ø´Ø´ Ù…Ø§Ù‡Ù‡ | Û³ÛµÛ¶ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '6_mounth_b')],
    ])
  );
});
bot.action('pro', (ctx) => {
  ctx.reply(`Ø³Ø±ÙˆÛŒØ³ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯`,
    Markup.inlineKeyboard([
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ ÛŒÚ© Ù…Ø§Ù‡Ù‡ | Û¹Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '1_mounth_p')],
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ Ø³Ù‡ Ù…Ø§Ù‡Ù‡ | Û²Û¶Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '3_mounth_p')],
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ Ø´Ø´ Ù…Ø§Ù‡Ù‡ | ÛµÛ³Û¶ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '6_mounth_p')],
    ])
  );
});
bot.action('vip', (ctx) => {
  ctx.reply(`Ø³Ø±ÙˆÛŒØ³ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯`,
    Markup.inlineKeyboard([
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ ÛŒÚ© Ù…Ø§Ù‡Ù‡ | Û±Û³Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '1_mounth_v')],
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ Ø³Ù‡ Ù…Ø§Ù‡Ù‡ | Û³Û¸Û¸ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '3_mounth_v')],
      [Markup.button.callback('Ø³Ø±ÙˆÛŒØ³ Ø´Ø´ Ù…Ø§Ù‡Ù‡ | Û·Û·Û¶ Ù‡Ø²Ø§Ø± ØªÙˆÙ…Ø§Ù†', '6_mounth_v')],
    ])
  );
});

const payDetailsMessage = botFuncs => {
  botFuncs.reply(`
    Ù„Ø·ÙØ§ Ù…Ø¨Ù„Øº ${price} ØªÙˆÙ…Ø§Ù† Ø±Ø§ Ø¨Ù‡ Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ø²ÛŒØ± Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡ Ùˆ ØªØµÙˆÛŒØ± Ø±Ø³ÛŒØ¯ Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯
    Ø³Ø±ÙˆÛŒØ³ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ØªØ§ Û± Ø³Ø§Ø¹Øª Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ ØªØµÙˆÛŒØ± Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ù…ÛŒØ´ÙˆØ¯ Ùˆ ØªÙˆØ³Ø· Ù‡Ù…ÛŒÙ† Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø·Ù„Ø§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯
    ___________________
    Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª:
    5892-1014-5434-6582
    Ø­Ø³ÛŒÙ† Ø¬Ø¹ÙØ±ÛŒ
    ___________________
    Ù¾Ø³ Ø§Ø² ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ø´Ù…Ø§ Ù…ÛŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø¯Ø³ØªÙˆØ± /currentService Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø³ØªÙ‡ Ø®ÙˆØ¯ Ø±Ø§ Ù„Ø­Ø¸Ù‡ Ø¨Ù‡ Ù„Ø­Ø¸Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯
  `)
}

// basic plan
bot.action('1_mounth_b', (ctx) => {
  price = 68;
  userPlanRequest = '1_mounth_b';
  payDetailsMessage(ctx);
});
bot.action('3_mounth_b', (ctx) => {
  price = 178;
  userPlanRequest = '3_mounth_b';
  payDetailsMessage(ctx);
});
bot.action('6_mounth_b', (ctx) => {
  price = 356;
  userPlanRequest = '6_mounth_b';
  payDetailsMessage(ctx);
});

// pro plan
bot.action('1_mounth_p', (ctx) => {
  price = 98;
  userPlanRequest = '1_mounth_p';
  payDetailsMessage(ctx);
});
bot.action('3_mounth_p', (ctx) => {
  price = 268;
  userPlanRequest = '3_mounth_p';
  payDetailsMessage(ctx);
});
bot.action('6_mounth_p', (ctx) => {
  price = 536;
  userPlanRequest = '6_mounth_p';
  payDetailsMessage(ctx);
});

// vip plan
bot.action('1_mounth_v', (ctx) => {
  price = 138;
  userPlanRequest = '1_mounth_v';
  payDetailsMessage(ctx);
});
bot.action('3_mounth_v', (ctx) => {
  price = 388;
  userPlanRequest = '3_mounth_v';
  payDetailsMessage(ctx);
});
bot.action('6_mounth_v', (ctx) => {
  price = 776;
  userPlanRequest = '6_mounth_v';
  payDetailsMessage(ctx);
});

// recieve photo and send it to admin
bot.on('photo', async (ctx) => {
  const userId = ctx.from.id;

  const userData = await User.findOne({ telegramId: userId });

  // Ø¹Ú©Ø³â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¢Ø±Ø§ÛŒÙ‡â€ŒØ§ÛŒ Ø§Ø² Ø³Ø§ÛŒØ²Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ù…ÛŒØ§Ù†ØŒ Ù…Ø§ Ø¨Ø²Ø±Ú¯â€ŒØªØ±ÛŒÙ† Ø±Ùˆ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒÙ…:
  const largestPhoto = ctx.message.photo[ctx.message.photo.length - 1];

  const fileId = largestPhoto.file_id;

  try {
    // Ø§Ø±Ø³Ø§Ù„ ÙØ§ÛŒÙ„ Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ†
    await ctx.telegram.sendPhoto(ADMIN_ID, fileId, {
      caption: `Ø¹Ú©Ø³ Ø§Ø² Ø·Ø±Ù Ú©Ø§Ø±Ø¨Ø±: ${ctx.from.first_name} (@${ctx.from.username || 'Ø¨Ø¯ÙˆÙ† ÛŒÙˆØ²Ø±Ù†ÛŒÙ…'})
        Ø¢ÛŒ Ø¯ÛŒ Ú©Ø§Ø±Ø¨Ø± : ${userData.telegramId}
        Ù†Ø§Ù… : ${userData.first_name || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}
        Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ : ${ userData.phoneNumber || 'ØªØ¹ÛŒÙ† Ù†Ú©Ø±Ø¯Ù‡' }
        Ù¾Ù„Ù† Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛŒ Ú©Ø§Ø±Ø¨Ø± : ${ userPlanRequest || 'ØªØ¹ÛŒÙ† Ù†Ú©Ø±Ø¯Ù‡' }
        Ù‚ÛŒÙ…Øª : ${ price || 'ØªØ¹ÛŒÙ† Ù†Ú©Ø±Ø¯Ù‡' }
      `,
    });

    await ctx.reply("Ø¨Ø³ØªÙ‡ Ø´Ù…Ø§ ØªØ§ Û± Ø³Ø§Ø¹Øª Ø¢ÛŒÙ†Ø¯Ù‡ ÙØ¹Ø§Ù„ Ø³Ø§Ø²ÛŒ Ùˆ ØªÙˆØ³Ø· Ù‡Ù…ÛŒÙ† Ø±Ø¨Ø§Øª Ø¨Ù‡ Ø´Ù…Ø§ Ø§Ø·Ù„Ø§Ø¹ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒØ´ÙˆØ¯. âœ… Ø¹Ú©Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.");
  } catch (error) {
    console.error("Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³:", error);
    await ctx.reply("âŒ Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³ Ù¾ÛŒØ´ Ø¢Ù…Ø¯. Ù„Ø·ÙØ§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯");
  }
});

// Ø¨Ù‚ÛŒÙ‡ Ú©Ø¯Ù‡Ø§ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ù…Ø§Ù†Ù†Ø¯ Ù‚Ø¨Ù„ Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯...
// [Ù‡Ù…Ù‡ Ú©Ø¯Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø´Ù…Ø§ Ø§Ø² Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù‡ Ø¨Ø¹Ø¯ Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ù†Ø¯]

// Ø§Ø¬Ø±Ø§ÛŒ Ø¨Ø§Øª
bot.launch()
  .then(() => {
    console.log("voidex activated");
    // ØªÙ†Ø¸ÛŒÙ… Ù…Ù†ÙˆÛŒ Ú†Ø³Ø¨Ø§Ù† Ù‡Ù†Ú¯Ø§Ù… Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ
    setupPersistentMenu();
  })
  .catch(err => console.error('Ø®Ø·Ø§ Ø¯Ø± Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø§Øª:', err));